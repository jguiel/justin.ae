<VirtualHost *:80>
    ServerName justin.ae
    ServerAlias www.justin.ae

    # Redirect all HTTP requests to HTTPS
    Redirect permanent / https://justin.ae/
</VirtualHost>

<VirtualHost *:443>
    ServerName justin.ae
    ServerAlias www.justin.ae

    DocumentRoot /var/www/html
    DirectoryIndex home.html

    SSLEngine on

    # URL rewriting rules (at VirtualHost level)
    RewriteEngine On
    RewriteRule ^/home/?$ /home.html [L]
    RewriteRule ^/analog_photography/?$ /analog_photography.html [L]
    RewriteRule ^/photography/?$ /photography.html [L]
    RewriteRule ^/infrared/?$ /infrared.html [L]
    RewriteRule ^/scripts/?$ /scripts.html [L]

    <Directory /var/www/html>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        
        # Prevent browser caching of HTML, CSS, and JS files
        <FilesMatch "\.(html|css|js)$">
            Header set Cache-Control "no-cache, no-store, must-revalidate"
            Header set Pragma "no-cache"
            Header set Expires "0"
        </FilesMatch>
        
        # Allow caching of images and other static assets
        <FilesMatch "\.(jpg|jpeg|png|gif|ico|svg|webp)$">
            Header set Cache-Control "public, max-age=3600"
        </FilesMatch>
    </Directory>

    ErrorDocument 404 /404.html
    ErrorDocument 500 /50x.html
    ErrorDocument 502 /50x.html
    ErrorDocument 503 /50x.html
    ErrorDocument 504 /50x.html
    SSLCertificateFile /etc/letsencrypt/live/justin.ae/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/justin.ae/privkey.pem
    Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>

